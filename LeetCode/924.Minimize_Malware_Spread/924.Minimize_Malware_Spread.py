#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from collections import defaultdict


class UnionFind:

    def __init__(self, n):
        self.parent = list(range(n))
        self.size = [1] * n

    def find(self, x):
        if self.parent[x] != x:
            self.parent[x] = self.find(self.parent[x])
        return self.parent[x]

    def union(self, x, y):
        rx, ry = self.find(x), self.find(y)
        if rx == ry:
            return False
        if self.size[rx] < self.size[ry]:
            rx, ry = ry, rx
        self.size[rx] += self.size[ry]
        self.parent[ry] = rx
        return True


class Solution:
    def minMalwareSpread(self, graph: list[list[int]], initial: list[int]) -> int:

        # i -> j graph[i][j] == 1
        # [1,1,0],
        # [1,1,0],
        # [0,0,1]

        # union find
        n = len(graph)
        uf = UnionFind(n)

        for i in range(n):
            for j in range(i + 1, n):
                if graph[i][j] == 1:
                    uf.union(i, j)

        # how many initial nodes can affect current component
        infect_count = defaultdict(int)
        for i in initial:
            parent = uf.find(i)
            infect_count[parent] += 1

        initial.sort()
        best, saved = initial[0], -1

        for i in initial:
            parent = uf.find(i)
            # this infected area only 1 initial node
            if infect_count[parent] == 1:
                if saved < uf.size[parent]:
                    saved = uf.size[parent]
                    best = i

        return best
